//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/Zetzsche/Development/SimarisCurves/com.thoughtworks.xstream/bin/src/com/thoughtworks/xstream/core/util/Base64Encoder.java
//


#line 1 "/Users/Zetzsche/Development/SimarisCurves/com.thoughtworks.xstream/bin/src/com/thoughtworks/xstream/core/util/Base64Encoder.java"

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "com/thoughtworks/xstream/core/util/Base64Encoder.h"
#include "java/io/ByteArrayOutputStream.h"
#include "java/io/IOException.h"
#include "java/io/Reader.h"
#include "java/io/StringReader.h"
#include "java/lang/Error.h"
#include "java/lang/Math.h"
#include "java/lang/StringBuffer.h"

@interface ComThoughtworksXstreamCoreUtilBase64Encoder ()

- (jint)mapCharToIntWithJavaIoReader:(JavaIoReader *)input;

@end

static IOSCharArray *ComThoughtworksXstreamCoreUtilBase64Encoder_SIXTY_FOUR_CHARS_;
J2OBJC_STATIC_FIELD_GETTER(ComThoughtworksXstreamCoreUtilBase64Encoder, SIXTY_FOUR_CHARS_, IOSCharArray *)

static IOSIntArray *ComThoughtworksXstreamCoreUtilBase64Encoder_REVERSE_MAPPING_;
J2OBJC_STATIC_FIELD_GETTER(ComThoughtworksXstreamCoreUtilBase64Encoder, REVERSE_MAPPING_, IOSIntArray *)

__attribute__((unused)) static jint ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(ComThoughtworksXstreamCoreUtilBase64Encoder *self, JavaIoReader *input);

J2OBJC_INITIALIZED_DEFN(ComThoughtworksXstreamCoreUtilBase64Encoder)


#line 30
@implementation ComThoughtworksXstreamCoreUtilBase64Encoder


#line 58
- (NSString *)encodeWithByteArray:(IOSByteArray *)input {
  JavaLangStringBuffer *result = new_JavaLangStringBuffer_init();
  jint outputCharCount = 0;
  for (jint i = 0; i < ((IOSByteArray *) nil_chk(input))->size_; i += 3) {
    jint remaining = JavaLangMath_minWithInt_withInt_(3, input->size_ - i);
    jint oneBigNumber = (LShift32((IOSByteArray_Get(input, i) & (jint) 0xff), 16)) | (LShift32((remaining <= 1 ? 0 : IOSByteArray_Get(input, i + 1) & (jint) 0xff), 8)) | (remaining <= 2 ? 0 : IOSByteArray_Get(input, i + 2) & (jint) 0xff);
    for (jint j = 0; j < 4; j++) (void) [result appendWithChar:remaining + 1 > j ? IOSCharArray_Get(nil_chk(ComThoughtworksXstreamCoreUtilBase64Encoder_SIXTY_FOUR_CHARS_), (jint) 0x3f & (RShift32(oneBigNumber, 6 * (3 - j)))) : '='];
    if ((outputCharCount += 4) % 76 == 0) (void) [result appendWithChar:0x000a];
  }
  return [result description];
}

- (IOSByteArray *)decodeWithNSString:(NSString *)input {
  @try {
    JavaIoByteArrayOutputStream *out = new_JavaIoByteArrayOutputStream_init();
    JavaIoStringReader *in = new_JavaIoStringReader_initWithNSString_(input);
    for (jint i = 0; i < ((jint) [((NSString *) nil_chk(input)) length]); i += 4) {
      IOSIntArray *a = [IOSIntArray newArrayWithInts:(jint[]){ ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(self, in), ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(self, in), ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(self, in), ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(self, in) } count:4];
      jint oneBigNumber = (LShift32((IOSIntArray_Get(a, 0) & (jint) 0x3f), 18)) | (LShift32((IOSIntArray_Get(a, 1) & (jint) 0x3f), 12)) | LShift32((IOSIntArray_Get(a, 2) & (jint) 0x3f), 6) | (IOSIntArray_Get(a, 3) & (jint) 0x3f);
      for (jint j = 0; j < 3; j++) if (IOSIntArray_Get(a, j + 1) >= 0) [out writeWithInt:(jint) 0xff & (RShift32(oneBigNumber, 8 * (2 - j)))];
    }
    return [out toByteArray];
  }
  @catch (
#line 80
  JavaIoIOException *e) {
    @throw new_JavaLangError_initWithNSString_(JreStrcat("@$$", e, @": ", [((JavaIoIOException *) nil_chk(e)) getMessage]));
  }
}


#line 85
- (jint)mapCharToIntWithJavaIoReader:(JavaIoReader *)input {
  return ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(self, input);
}

- (instancetype)init {
  ComThoughtworksXstreamCoreUtilBase64Encoder_init(self);
  return self;
}

+ (void)initialize {
  if (self == [ComThoughtworksXstreamCoreUtilBase64Encoder class]) {
    ComThoughtworksXstreamCoreUtilBase64Encoder_SIXTY_FOUR_CHARS_ =
#line 51
    [@"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/" toCharArray];
    ComThoughtworksXstreamCoreUtilBase64Encoder_REVERSE_MAPPING_ = [IOSIntArray newArrayWithLength:
#line 52
    123];
    {
      
#line 55
      for (jint i = 0; i < ((IOSCharArray *) nil_chk(ComThoughtworksXstreamCoreUtilBase64Encoder_SIXTY_FOUR_CHARS_))->size_; i++) *IOSIntArray_GetRef(ComThoughtworksXstreamCoreUtilBase64Encoder_REVERSE_MAPPING_, IOSCharArray_Get(ComThoughtworksXstreamCoreUtilBase64Encoder_SIXTY_FOUR_CHARS_, i)) = i + 1;
    }
    J2OBJC_SET_INITIALIZED(ComThoughtworksXstreamCoreUtilBase64Encoder)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "encodeWithByteArray:", "encode", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "decodeWithNSString:", "decode", "[B", 0x1, NULL, NULL },
    { "mapCharToIntWithJavaIoReader:", "mapCharToInt", "I", 0x2, "Ljava.io.IOException;", NULL },
    { "init", NULL, NULL, 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "SIXTY_FOUR_CHARS_", NULL, 0x1a, "[C", &ComThoughtworksXstreamCoreUtilBase64Encoder_SIXTY_FOUR_CHARS_, NULL,  },
    { "REVERSE_MAPPING_", NULL, 0x1a, "[I", &ComThoughtworksXstreamCoreUtilBase64Encoder_REVERSE_MAPPING_, NULL,  },
  };
  static const J2ObjcClassInfo _ComThoughtworksXstreamCoreUtilBase64Encoder = { 2, "Base64Encoder", "com.thoughtworks.xstream.core.util", NULL, 0x1, 4, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_ComThoughtworksXstreamCoreUtilBase64Encoder;
}

@end


#line 85
jint ComThoughtworksXstreamCoreUtilBase64Encoder_mapCharToIntWithJavaIoReader_(ComThoughtworksXstreamCoreUtilBase64Encoder *self, JavaIoReader *input) {
  jint c;
  while ((c = [((JavaIoReader *) nil_chk(input)) read]) != -1) {
    jint result = IOSIntArray_Get(nil_chk(ComThoughtworksXstreamCoreUtilBase64Encoder_REVERSE_MAPPING_), c);
    if (result != 0) return result - 1;
    if (c == '=') return -1;
  }
  return -1;
}

void ComThoughtworksXstreamCoreUtilBase64Encoder_init(ComThoughtworksXstreamCoreUtilBase64Encoder *self) {
  (void) NSObject_init(self);
}

ComThoughtworksXstreamCoreUtilBase64Encoder *new_ComThoughtworksXstreamCoreUtilBase64Encoder_init() {
  ComThoughtworksXstreamCoreUtilBase64Encoder *self = [ComThoughtworksXstreamCoreUtilBase64Encoder alloc];
  ComThoughtworksXstreamCoreUtilBase64Encoder_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComThoughtworksXstreamCoreUtilBase64Encoder)
