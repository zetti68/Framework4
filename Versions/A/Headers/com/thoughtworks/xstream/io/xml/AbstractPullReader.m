//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/Zetzsche/Development/SimarisCurves/com.thoughtworks.xstream/src/com/thoughtworks/xstream/io/xml/AbstractPullReader.java
//

#line 1 "/Users/Zetzsche/Development/SimarisCurves/com.thoughtworks.xstream/src/com/thoughtworks/xstream/io/xml/AbstractPullReader.java"

#include "com/thoughtworks/xstream/core/util/FastStack.h"
#include "com/thoughtworks/xstream/io/AttributeNameIterator.h"
#include "com/thoughtworks/xstream/io/naming/NameCoder.h"
#include "com/thoughtworks/xstream/io/xml/AbstractPullReader.h"
#include "com/thoughtworks/xstream/io/xml/AbstractXmlReader.h"
#include "com/thoughtworks/xstream/io/xml/XmlFriendlyReplacer.h"
#include "java/lang/RuntimeException.h"
#include "java/lang/StringBuffer.h"
#include "java/util/Iterator.h"


#line 27
@implementation ComThoughtworksXstreamIoXmlAbstractPullReader


#line 50
- (instancetype)initComThoughtworksXstreamIoXmlAbstractPullReaderWithComThoughtworksXstreamIoNamingNameCoder:(id<ComThoughtworksXstreamIoNamingNameCoder>)nameCoder {
  if (self =
#line 51
  [super initWithComThoughtworksXstreamIoNamingNameCoder:nameCoder]) {
    elementStack_ =
#line 35
    [[ComThoughtworksXstreamCoreUtilFastStack alloc] initWithInt:16];
    pool_ =
#line 36
    [[ComThoughtworksXstreamCoreUtilFastStack alloc] initWithInt:16];
    lookahead_ =
#line 38
    [[ComThoughtworksXstreamCoreUtilFastStack alloc] initWithInt:4];
    lookback_ =
#line 39
    [[ComThoughtworksXstreamCoreUtilFastStack alloc] initWithInt:4];
  }
  return self;
}

- (instancetype)initWithComThoughtworksXstreamIoNamingNameCoder:(id<ComThoughtworksXstreamIoNamingNameCoder>)nameCoder {
  return [self initComThoughtworksXstreamIoXmlAbstractPullReaderWithComThoughtworksXstreamIoNamingNameCoder:
#line 50
nameCoder];
}


#line 58
- (instancetype)initWithComThoughtworksXstreamIoXmlXmlFriendlyReplacer:(ComThoughtworksXstreamIoXmlXmlFriendlyReplacer *)replacer {
  return
#line 59
  [self initComThoughtworksXstreamIoXmlAbstractPullReaderWithComThoughtworksXstreamIoNamingNameCoder:(id<ComThoughtworksXstreamIoNamingNameCoder>) check_protocol_cast(replacer, @protocol(ComThoughtworksXstreamIoNamingNameCoder))];
}


#line 72
- (jint)pullNextEvent {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}


#line 77
- (NSString *)pullElementName {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}


#line 82
- (NSString *)pullText {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}


#line 84
- (jboolean)hasMoreChildren {
  
#line 85
  [self mark];
  while (YES) {
    switch (((ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) nil_chk([self readEvent]))->type_) {
      case ComThoughtworksXstreamIoXmlAbstractPullReader_START_NODE:
      [self reset];
      return YES;
      case ComThoughtworksXstreamIoXmlAbstractPullReader_END_NODE:
      [self reset];
      return NO;
      default:
      continue;
    }
  }
}


#line 100
- (void)moveDown {
  
#line 101
  jint currentDepth = [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(elementStack_)) size];
  while ([elementStack_ size] <= currentDepth) {
    [self move];
    if ([elementStack_ size] < currentDepth) {
      @throw [[JavaLangRuntimeException alloc] init];
    }
  }
}


#line 110
- (void)moveUp {
  
#line 111
  jint currentDepth = [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(elementStack_)) size];
  while ([elementStack_ size] >= currentDepth) {
    [self move];
  }
}


#line 117
- (void)move {
  
#line 118
  ComThoughtworksXstreamIoXmlAbstractPullReader_Event *event = [self readEvent];
  (void) [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(pool_)) pushWithId:event];
  switch (((ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) nil_chk(event))->type_) {
    case ComThoughtworksXstreamIoXmlAbstractPullReader_START_NODE:
    (void) [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(elementStack_)) pushWithId:[self pullElementName]];
    break;
    case ComThoughtworksXstreamIoXmlAbstractPullReader_END_NODE:
    (void) [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(elementStack_)) pop];
    break;
  }
}


#line 130
- (ComThoughtworksXstreamIoXmlAbstractPullReader_Event *)readEvent {
  
#line 131
  if (marked_) {
    if ([((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(lookback_)) hasStuff]) {
      return (ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) check_class_cast([((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(lookahead_)) pushWithId:[lookback_ pop]], [ComThoughtworksXstreamIoXmlAbstractPullReader_Event class]);
    }
    else {
      
#line 135
      return (ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) check_class_cast([((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(lookahead_)) pushWithId:[self readRealEvent]], [ComThoughtworksXstreamIoXmlAbstractPullReader_Event class]);
    }
  }
  else {
    
#line 138
    if ([((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(lookback_)) hasStuff]) {
      return (ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) check_class_cast([lookback_ pop], [ComThoughtworksXstreamIoXmlAbstractPullReader_Event class]);
    }
    else {
      
#line 141
      return [self readRealEvent];
    }
  }
}


#line 146
- (ComThoughtworksXstreamIoXmlAbstractPullReader_Event *)readRealEvent {
  
#line 147
  ComThoughtworksXstreamIoXmlAbstractPullReader_Event *event = [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(pool_)) hasStuff] ? (ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) check_class_cast([pool_ pop], [ComThoughtworksXstreamIoXmlAbstractPullReader_Event class]) : [[ComThoughtworksXstreamIoXmlAbstractPullReader_Event alloc] init];
  event->type_ = [self pullNextEvent];
  if (event->type_ == ComThoughtworksXstreamIoXmlAbstractPullReader_TEXT) {
    event->value_ = [self pullText];
  }
  else
#line 151
  if (event->type_ == ComThoughtworksXstreamIoXmlAbstractPullReader_START_NODE) {
    event->value_ = [self pullElementName];
  }
  else {
    
#line 154
    event->value_ = nil;
  }
  return event;
}


#line 159
- (void)mark {
  
#line 160
  marked_ = YES;
}


#line 163
- (void)reset {
  
#line 164
  while ([((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(lookahead_)) hasStuff]) {
    (void) [((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(lookback_)) pushWithId:[lookahead_ pop]];
  }
  marked_ = NO;
}


#line 170
- (NSString *)getValue {
  
#line 176
  NSString *last = nil;
  JavaLangStringBuffer *buffer = nil;
  
#line 179
  [self mark];
  ComThoughtworksXstreamIoXmlAbstractPullReader_Event *event = [self readEvent];
  while (YES) {
    if (((ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) nil_chk(event))->type_ == ComThoughtworksXstreamIoXmlAbstractPullReader_TEXT) {
      NSString *text = event->value_;
      if (text != nil && ((jint) [text length]) > 0) {
        if (last == nil) {
          last = text;
        }
        else {
          
#line 188
          if (buffer == nil) {
            buffer = [[JavaLangStringBuffer alloc] initWithNSString:last];
          }
          (void) [((JavaLangStringBuffer *) nil_chk(buffer)) appendWithNSString:text];
        }
      }
    }
    else
#line 194
    if (event->type_ != ComThoughtworksXstreamIoXmlAbstractPullReader_COMMENT) {
      break;
    }
    event = [self readEvent];
  }
  [self reset];
  if (buffer != nil) {
    return [buffer description];
  }
  else {
    
#line 203
    return (last == nil) ? @"" : last;
  }
}


#line 207
- (id<JavaUtilIterator>)getAttributeNames {
  
#line 208
  return [[ComThoughtworksXstreamIoAttributeNameIterator alloc] initWithComThoughtworksXstreamIoHierarchicalStreamReader:self];
}


#line 211
- (NSString *)getNodeName {
  
#line 212
  return [self unescapeXmlNameWithNSString:(NSString *) check_class_cast([((ComThoughtworksXstreamCoreUtilFastStack *) nil_chk(elementStack_)) peek], [NSString class])];
}


#line 215
- (NSString *)peekNextChild {
  
#line 216
  [self mark];
  while (YES) {
    ComThoughtworksXstreamIoXmlAbstractPullReader_Event *ev = [self readEvent];
    switch (((ComThoughtworksXstreamIoXmlAbstractPullReader_Event *) nil_chk(ev))->type_) {
      case ComThoughtworksXstreamIoXmlAbstractPullReader_START_NODE:
      [self reset];
      return ev->value_;
      case ComThoughtworksXstreamIoXmlAbstractPullReader_END_NODE:
      [self reset];
      return nil;
      default:
      continue;
    }
  }
}

- (void)copyAllFieldsTo:(ComThoughtworksXstreamIoXmlAbstractPullReader *)other {
  [super copyAllFieldsTo:other];
  other->elementStack_ = elementStack_;
  other->lookahead_ = lookahead_;
  other->lookback_ = lookback_;
  other->marked_ = marked_;
  other->pool_ = pool_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithComThoughtworksXstreamIoNamingNameCoder:", "AbstractPullReader", NULL, 0x4, NULL },
    { "initWithComThoughtworksXstreamIoXmlXmlFriendlyReplacer:", "AbstractPullReader", NULL, 0x4, NULL },
    { "pullNextEvent", NULL, "I", 0x404, NULL },
    { "pullElementName", NULL, "Ljava.lang.String;", 0x404, NULL },
    { "pullText", NULL, "Ljava.lang.String;", 0x404, NULL },
    { "hasMoreChildren", NULL, "Z", 0x1, NULL },
    { "moveDown", NULL, "V", 0x1, NULL },
    { "moveUp", NULL, "V", 0x1, NULL },
    { "move", NULL, "V", 0x2, NULL },
    { "readEvent", NULL, "Lcom.thoughtworks.xstream.io.xml.AbstractPullReader$Event;", 0x2, NULL },
    { "readRealEvent", NULL, "Lcom.thoughtworks.xstream.io.xml.AbstractPullReader$Event;", 0x2, NULL },
    { "mark", NULL, "V", 0x1, NULL },
    { "reset", NULL, "V", 0x1, NULL },
    { "getValue", NULL, "Ljava.lang.String;", 0x1, NULL },
    { "getAttributeNames", NULL, "Ljava.util.Iterator;", 0x1, NULL },
    { "getNodeName", NULL, "Ljava.lang.String;", 0x1, NULL },
    { "peekNextChild", NULL, "Ljava.lang.String;", 0x1, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "START_NODE_", NULL, 0x1c, "I", NULL, .constantValue.asInt = ComThoughtworksXstreamIoXmlAbstractPullReader_START_NODE },
    { "END_NODE_", NULL, 0x1c, "I", NULL, .constantValue.asInt = ComThoughtworksXstreamIoXmlAbstractPullReader_END_NODE },
    { "TEXT_", NULL, 0x1c, "I", NULL, .constantValue.asInt = ComThoughtworksXstreamIoXmlAbstractPullReader_TEXT },
    { "COMMENT_", NULL, 0x1c, "I", NULL, .constantValue.asInt = ComThoughtworksXstreamIoXmlAbstractPullReader_COMMENT },
    { "OTHER_", NULL, 0x1c, "I", NULL, .constantValue.asInt = ComThoughtworksXstreamIoXmlAbstractPullReader_OTHER },
    { "elementStack_", NULL, 0x12, "Lcom.thoughtworks.xstream.core.util.FastStack;", NULL,  },
    { "pool_", NULL, 0x12, "Lcom.thoughtworks.xstream.core.util.FastStack;", NULL,  },
    { "lookahead_", NULL, 0x12, "Lcom.thoughtworks.xstream.core.util.FastStack;", NULL,  },
    { "lookback_", NULL, 0x12, "Lcom.thoughtworks.xstream.core.util.FastStack;", NULL,  },
    { "marked_", NULL, 0x2, "Z", NULL,  },
  };
  static const J2ObjcClassInfo _ComThoughtworksXstreamIoXmlAbstractPullReader = { "AbstractPullReader", "com.thoughtworks.xstream.io.xml", NULL, 0x401, 17, methods, 10, fields, 0, NULL};
  return &_ComThoughtworksXstreamIoXmlAbstractPullReader;
}

@end


#line 42
@implementation ComThoughtworksXstreamIoXmlAbstractPullReader_Event

- (instancetype)init {
  return [super init];
}

- (void)copyAllFieldsTo:(ComThoughtworksXstreamIoXmlAbstractPullReader_Event *)other {
  [super copyAllFieldsTo:other];
  other->type_ = type_;
  other->value_ = value_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", NULL, NULL, 0x2, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "type_", NULL, 0x0, "I", NULL,  },
    { "value_", NULL, 0x0, "Ljava.lang.String;", NULL,  },
  };
  static const J2ObjcClassInfo _ComThoughtworksXstreamIoXmlAbstractPullReader_Event = { "Event", "com.thoughtworks.xstream.io.xml", "AbstractPullReader", 0xa, 1, methods, 2, fields, 0, NULL};
  return &_ComThoughtworksXstreamIoXmlAbstractPullReader_Event;
}

@end
